<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="mobomobo.dao.face.MovieDebateDao">

	<select id="selectDebateCntAll" resultType="int" parameterType="mobomobo.util.DebatePaging">
		SELECT COUNT(*) FROM debate
	</select>
	
	<select id="selectDebateList" resultType="mobomobo.dto.Debate" parameterType="mobomobo.util.DebatePaging">
		SELECT * FROM (
		    SELECT rownum rnum, B.* FROM (
		    	SELECT * FROM debate
		        ORDER BY dno DESC
		    ) B
		) R
		WHERE rnum BETWEEN #{startNo} AND #{endNo}
	</select>

	<select id="selectByDebateNo" parameterType="Debate"	resultType="Debate">
        SELECT
        	dno, dTitle, dContent, userno, nick, dDate, hit, boardDiv
        FROM debate
		WHERE dno = #{dNo }
	</select>
	
	<update id="updateHit" parameterType="Debate">
		UPDATE debate SET hit = hit + 1
		WHERE dno = #{dNo }
	</update>
	
	<insert id="insertDebate" parameterType="Debate">
		insert into debate ( dNo, dTitle, dContent, userno, nick, boardDiv)
		VALUES ( dNo_seq.nextval,#{dTitle}, #{dContent}, #{userno}, #{nick}, 4 )
	</insert>
	
	
	<select id="selectDebateHotNo" resultType="int">
		select dhNo_seq.nextval from dual
	</select>
	
	<select id="selectDebateHotBydNouserNo" resultType="int" parameterType="mobomobo.dto.DebateHot">
		select count(*) from debatehot
		where dno = #{dNo } and userno = #{userno }
	</select>
	
	<insert id="insertDebateHot" parameterType="mobomobo.dto.DebateHot">
		insert into debatehot(dhno,dno,userno)
		values(#{dhNo },#{dNo },#{userno })
	</insert>
	
	<delete id="deleteDebateHot" parameterType="mobomobo.dto.DebateHot">
		delete from debatehot
		where dNo = #{dNo } and userno = #{userno }
	</delete>

	<select id="selectAllDebateHot" resultType="int" parameterType="mobomobo.dto.DebateHot">
		select count(*) from debatehot 
		where dno = #{dNo }
	</select>	
	
</mapper>	
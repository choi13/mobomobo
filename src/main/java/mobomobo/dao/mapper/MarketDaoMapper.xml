<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mobomobo.dao.face.MarketDao">

	<sql id="selectMarket">
		SELECT
		mNo, mTitle, mContent, 
		mViews, mDate, mPrice, mCate
		FROM Market
	</sql>
	
	<sql id="titleSearch">
		WHERE mTitle LIKE '%' || #{search} || '%'
	</sql>

	<select id="SelectAll" parameterType="mobomobo.admin.util.Paging" resultType="mobomobo.dto.Market">
		SELECT * FROM (
		    SELECT rownum rnum, B.* FROM (
		        <include refid="selectMarket"/>
		        <include refid="titleSearch"/>
		        ORDER BY mNo DESC
		    ) B
		) R
		WHERE rnum BETWEEN #{startNo} AND #{endNo}
	</select>

	<select id="SelectCntAll" resultType="int">
		Select count(*) from (
			<include refid="selectMarket"/>
		    <include refid="titleSearch"/>
		)
	</select>

</mapper>